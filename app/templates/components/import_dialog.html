{# Import Dialog - CSV-Import Modal #}
{# Wird via openModal('/api/jobs/import-dialog') geladen #}

<div class="bg-white px-4 pb-4 pt-5 sm:p-6">
    <div class="sm:flex sm:items-start">
        <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-primary-100 sm:mx-0 sm:h-10 sm:w-10">
            <svg class="h-6 w-6 text-primary-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" />
            </svg>
        </div>
        <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left flex-1">
            <h3 class="text-base font-semibold leading-6 text-gray-900">Jobs importieren</h3>
            <div class="mt-2">
                <p class="text-sm text-gray-500">
                    Laden Sie eine CSV-Datei (Tab-getrennt) mit Stellenausschreibungen hoch.
                    Maximal 10.000 Zeilen, 50 MB.
                </p>
            </div>

            {# Upload Form #}
            <form id="import-form"
                  hx-post="/api/jobs/import"
                  hx-encoding="multipart/form-data"
                  hx-target="#import-status"
                  hx-swap="innerHTML"
                  class="mt-4">

                {# File Input #}
                <div x-data="{ fileName: '', dragging: false }"
                     class="relative">
                    <div @dragover.prevent="dragging = true"
                         @dragleave.prevent="dragging = false"
                         @drop.prevent="dragging = false; fileName = $event.dataTransfer.files[0]?.name || ''; $refs.fileInput.files = $event.dataTransfer.files"
                         :class="{ 'border-primary-500 bg-primary-50': dragging }"
                         class="flex justify-center rounded-lg border border-dashed border-gray-300 px-6 py-10 transition-colors">
                        <div class="text-center">
                            <svg class="mx-auto h-12 w-12 text-gray-300" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m6.75 12l-3-3m0 0l-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                            </svg>
                            <div class="mt-4 flex text-sm leading-6 text-gray-600 justify-center">
                                <label for="csv-file"
                                       class="relative cursor-pointer rounded-md bg-white font-semibold text-primary-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-primary-600 focus-within:ring-offset-2 hover:text-primary-500">
                                    <span>Datei auswaehlen</span>
                                    <input id="csv-file"
                                           name="file"
                                           type="file"
                                           accept=".csv,.txt,.tsv"
                                           x-ref="fileInput"
                                           @change="fileName = $event.target.files[0]?.name || ''"
                                           class="sr-only"
                                           required>
                                </label>
                                <p class="pl-1">oder per Drag & Drop</p>
                            </div>
                            <p class="text-xs leading-5 text-gray-600">CSV, TSV oder TXT bis 50 MB</p>
                            <p x-show="fileName" x-text="'Ausgewaehlt: ' + fileName" class="mt-2 text-sm font-medium text-primary-600"></p>
                        </div>
                    </div>
                </div>
            </form>

            {# Import Status #}
            <div id="import-status" class="mt-4">
                {# Wird nach Upload durch HTMX ersetzt #}
            </div>
        </div>
    </div>
</div>
<div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
    <button type="submit"
            form="import-form"
            class="inline-flex w-full justify-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 sm:ml-3 sm:w-auto">
        <svg class="h-4 w-4 mr-1 htmx-indicator animate-spin" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Importieren
    </button>
    <button type="button"
            onclick="closeModal()"
            class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">
        Abbrechen
    </button>
</div>
