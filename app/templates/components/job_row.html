{# Job Row — Premium Dark Theme Listenzeile #}
{# Verwendung: {% include 'components/job_row.html' %} #}
{# Parameter: job (Job-Dict aus Service) #}

{% set addr_parts = [] %}
{% if job.street_address %}{% set _ = addr_parts.append(job.street_address) %}{% endif %}
{% if job.postal_code %}{% set _ = addr_parts.append(job.postal_code) %}{% endif %}
{% if job.work_location_city %}{% set _ = addr_parts.append(job.work_location_city) %}{% elif job.city %}{% set _ = addr_parts.append(job.city) %}{% endif %}

<div style="display:grid;grid-template-columns:40px 3fr 2fr 2fr 2fr 120px;gap:8px;padding:12px 18px;border-bottom:1px solid var(--pp-border);align-items:center;transition:background 0.15s;"
     onmouseover="this.style.background='rgba(79,140,255,0.03)'"
     onmouseout="this.style.background='transparent'"
     id="job-row-{{ job.id }}">

    {# Checkbox #}
    <div>
        <input type="checkbox"
               name="selected_jobs"
               value="{{ job.id }}"
               style="width:16px;height:16px;border-radius:4px;cursor:pointer;">
    </div>

    {# Position + Unternehmen #}
    <div style="min-width:0;">
        <a href="/jobs/{{ job.id }}"
           style="font-size:13px;font-weight:600;color:var(--pp-text);text-decoration:none;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;transition:color 0.15s;"
           onmouseover="this.style.color='var(--pp-accent)'"
           onmouseout="this.style.color='var(--pp-text)'">
            {{ job.position | default('Keine Position') }}
        </a>
        {% if job.employment_type %}
        <span style="font-size:11px;color:var(--pp-purple);font-weight:500;">{{ job.employment_type }}</span>
        {% endif %}
    </div>

    {# Unternehmen (klickbar) #}
    <div style="min-width:0;">
        {% if job.company_id %}
        <a href="/unternehmen/{{ job.company_id }}"
           style="font-size:13px;color:var(--pp-accent);text-decoration:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;transition:color 0.15s;"
           onmouseover="this.style.textDecoration='underline'"
           onmouseout="this.style.textDecoration='none'">
            {{ job.company_name }}
        </a>
        {% else %}
        <span style="font-size:13px;color:var(--pp-textMuted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;">{{ job.company_name }}</span>
        {% endif %}
    </div>

    {# Adresse #}
    <div style="min-width:0;">
        <span style="font-size:12px;color:var(--pp-textMuted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;" title="{{ addr_parts | join(', ') }}">
            {{ addr_parts | join(', ') or '—' }}
        </span>
    </div>

    {# Importiert #}
    <div>
        {% if job.imported_at is defined and job.imported_at is not none %}
        <span style="font-size:12px;color:var(--pp-textMuted);" title="Importiert: {{ job.imported_at.strftime('%d.%m.%Y %H:%M') }}">
            {{ job.imported_at.strftime('%d.%m.%Y') }}
        </span>
        {% elif job.created_at is defined and job.created_at is not none %}
        <span style="font-size:12px;color:var(--pp-textMuted);">
            {{ job.created_at.strftime('%d.%m.%Y') }}
        </span>
        {% else %}
        <span style="font-size:12px;color:var(--pp-textDim);">—</span>
        {% endif %}
        {% if job.last_updated_at is defined and job.last_updated_at is not none %}
        <span style="display:block;font-size:11px;color:var(--pp-accent);" title="Aktualisiert: {{ job.last_updated_at.strftime('%d.%m.%Y %H:%M') }}">
            upd. {{ job.last_updated_at.strftime('%d.%m.') }}
        </span>
        {% endif %}
    </div>

    {# Aktionen #}
    <div style="display:flex;align-items:center;justify-content:flex-end;gap:2px;">
        {% if job.job_url %}
        <a href="{{ job.job_url }}"
           target="_blank"
           rel="noopener noreferrer"
           style="padding:6px;border-radius:7px;color:var(--pp-textDim);transition:all 0.15s;display:flex;"
           onmouseover="this.style.color='var(--pp-accent)';this.style.background='var(--pp-accentSoft)'"
           onmouseout="this.style.color='var(--pp-textDim)';this.style.background='transparent'"
           title="Extern oeffnen">
            <svg style="width:14px;height:14px;" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" />
            </svg>
        </a>
        {% endif %}
        <a href="/jobs/{{ job.id }}"
           style="padding:6px;border-radius:7px;color:var(--pp-textDim);transition:all 0.15s;display:flex;"
           onmouseover="this.style.color='var(--pp-accent)';this.style.background='var(--pp-accentSoft)'"
           onmouseout="this.style.color='var(--pp-textDim)';this.style.background='transparent'"
           title="Details">
            <svg style="width:14px;height:14px;" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        </a>
    </div>
</div>
