{# Partial: Alle Aktivitaeten eines Unternehmens (chronologisch, neueste zuerst) #}
{# Sammelt: Anrufe, E-Mails, Aufgaben — fuer Firma + alle Kontakte #}

{% if activities and activities | length > 0 %}
<div style="display:flex;flex-direction:column;gap:2px;">
    {% for item in activities %}
    <div style="display:flex;align-items:flex-start;gap:12px;padding:12px 14px;border-bottom:1px solid #f1f5f9;transition:background 0.15s;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='transparent'">
        {# Icon nach Typ #}
        <div style="flex-shrink:0;width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px;
            {% if item.type == 'call' %}background:#eef5fb;{% elif item.type == 'email_out' %}background:#eef5fb;{% elif item.type == 'email_in' %}background:#f0fdf4;{% elif item.type == 'todo' %}background:#fffbeb;{% else %}background:#f1f5f9;{% endif %}
        ">
            {% if item.type == 'call' %}&#x1F4DE;{% elif item.type == 'email_out' %}&#x2709;&#xFE0F;{% elif item.type == 'email_in' %}&#x1F4E8;{% elif item.type == 'todo' %}&#x2705;{% else %}&#x1F4CC;{% endif %}
        </div>
        <div style="flex:1;min-width:0;">
            <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
                {# Typ-Badge #}
                {% if item.type == 'call' %}
                <span style="display:inline-flex;align-items:center;padding:2px 8px;border-radius:6px;font-size:11px;font-weight:650;background:#eef5fb;color:#0b69b6;">Anruf</span>
                {% elif item.type == 'email_out' %}
                <span style="display:inline-flex;align-items:center;padding:2px 8px;border-radius:6px;font-size:11px;font-weight:650;background:#eef5fb;color:#0b69b6;">E-Mail &#x2192;</span>
                {% elif item.type == 'email_in' %}
                <span style="display:inline-flex;align-items:center;padding:2px 8px;border-radius:6px;font-size:11px;font-weight:650;background:#f0fdf4;color:#4a9624;">E-Mail &#x2190;</span>
                {% elif item.type == 'todo' %}
                <span style="display:inline-flex;align-items:center;padding:2px 8px;border-radius:6px;font-size:11px;font-weight:650;background:#fffbeb;color:#d97706;">Aufgabe</span>
                {% endif %}

                {# Kontakt-Name (falls vorhanden) #}
                {% if item.contact_name %}
                <span style="font-size:12px;color:#0b69b6;font-weight:600;">{{ item.contact_name }}</span>
                {% endif %}
            </div>

            {# Titel / Zusammenfassung #}
            <p style="font-size:13px;color:#1e293b;margin:3px 0 0;line-height:1.4;">{{ item.title }}</p>

            {# Body-Vorschau (falls vorhanden) #}
            {% if item.body %}
            <p style="font-size:12px;color:#64748b;margin:2px 0 0;line-height:1.3;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;">{{ item.body }}</p>
            {% endif %}

            {# Meta-Infos #}
            <div style="display:flex;align-items:center;gap:10px;margin-top:4px;font-size:11px;color:#94a3b8;">
                {% if item.type == 'call' and item.duration %}
                <span>&#x1F551; {{ item.duration }} Min.</span>
                {% endif %}
                {% if item.type == 'call' and item.call_type %}
                <span>{{ item.call_type }}</span>
                {% endif %}
                {% if item.type == 'todo' and item.status %}
                <span>{{ item.status }}</span>
                {% endif %}
                {% if item.type == 'todo' and item.priority %}
                <span>{{ item.priority }}</span>
                {% endif %}
            </div>
        </div>

        {# Datum rechts #}
        <div style="flex-shrink:0;text-align:right;min-width:80px;">
            <span style="font-size:11px;color:#94a3b8;font-weight:500;">{{ item.date | datetime }}</span>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<p style="font-size:14px;color:#94a3b8;padding:16px 0;">Keine Aktivitäten vorhanden</p>
{% endif %}
