{# Partial: Notizen-Verlauf eines Kandidaten (neueste zuerst) #}

{% if notes and notes | length > 0 %}
<div style="display:flex;flex-direction:column;gap:2px;">
    {% for note in notes %}
    <div style="display:flex;align-items:flex-start;gap:12px;padding:12px 14px;border-bottom:1px solid var(--pp-border);transition:background 0.15s;" onmouseover="this.style.background='var(--pp-surfaceHover)'" onmouseout="this.style.background='transparent'">
        {# Icon je nach Quelle #}
        <div style="flex-shrink:0;width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px;
            {% if note.source == 'ki_transkription' %}background:rgba(52,211,153,0.12);
            {% elif note.source == 'n8n' %}background:rgba(79,140,255,0.12);
            {% else %}background:var(--pp-orangeSoft);{% endif %}">
            {% if note.source == 'ki_transkription' %}&#x1F399;
            {% elif note.source == 'n8n' %}&#x1F916;
            {% elif note.source == 'system' %}&#x2699;
            {% else %}&#x1F4DD;{% endif %}
        </div>
        <div style="flex:1;min-width:0;">
            <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
                {% if note.title %}
                <span style="font-size:13px;color:var(--pp-text);font-weight:600;">{{ note.title }}</span>
                {% endif %}
                {% if note.source %}
                <span style="font-size:11px;padding:2px 8px;border-radius:6px;font-weight:500;
                    {% if note.source == 'ki_transkription' %}background:rgba(52,211,153,0.12);color:var(--pp-green);
                    {% elif note.source == 'n8n' %}background:rgba(79,140,255,0.12);color:var(--pp-accent);
                    {% elif note.source == 'system' %}background:var(--pp-surfaceHover);color:var(--pp-textDim);
                    {% else %}background:var(--pp-surfaceHover);color:var(--pp-textMuted);{% endif %}">
                    {% if note.source == 'ki_transkription' %}KI
                    {% elif note.source == 'n8n' %}Automatisch
                    {% elif note.source == 'system' %}System
                    {% else %}Manuell{% endif %}
                </span>
                {% endif %}
            </div>

            {# Inhalt #}
            <p style="font-size:13px;color:var(--pp-textMuted);margin:3px 0 0;line-height:1.5;white-space:pre-wrap;">{{ note.content }}</p>
        </div>

        {# Datum + Loeschen #}
        <div style="flex-shrink:0;text-align:right;min-width:90px;display:flex;flex-direction:column;align-items:flex-end;gap:4px;">
            <span style="font-size:11px;color:var(--pp-textDim);font-weight:500;">{{ note.note_date | datetime }}</span>
            <button onclick="deleteCandidateNote('{{ note.id }}', '{{ candidate_id }}')"
                    class="cursor-pointer"
                    style="background:none;border:none;color:var(--pp-textDim);font-size:12px;padding:2px 4px;"
                    onmouseover="this.style.color='var(--pp-red)'"
                    onmouseout="this.style.color='var(--pp-textDim)'"
                    title="Notiz loeschen">&#x2715;</button>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<p style="font-size:14px;color:var(--pp-textDim);padding:16px 14px;">Keine Notizen vorhanden</p>
{% endif %}
