{# Partial: ATS-Stellen eines Unternehmens #}

{% if ats_jobs and ats_jobs | length > 0 %}
<div class="space-y-2">
    {% for job in ats_jobs %}
    <a href="/ats/stellen/{{ job.id }}" class="block p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors group">
        <div class="flex items-center justify-between">
            <p class="text-sm font-medium text-gray-900 group-hover:text-primary-600 truncate">{{ job.title }}</p>
            {# Pipeline Badge #}
            {% if job.in_pipeline %}
            <span class="inline-flex items-center rounded-full bg-primary-50 px-2 py-0.5 text-xs font-medium text-primary-700 ring-1 ring-primary-600/20">
                Pipeline
            </span>
            {% endif %}
        </div>
        <div class="flex items-center gap-2 mt-1">
            {% if job.location_city %}
            <span class="text-xs text-gray-500">{{ job.location_city }}</span>
            {% endif %}
            {% if job.employment_type %}
            <span class="text-xs text-gray-400">&middot; {{ job.employment_type }}</span>
            {% endif %}
            {# Status Badge #}
            {% set status_colors = {
                'open': 'bg-green-100 text-green-700',
                'paused': 'bg-amber-100 text-amber-700',
                'filled': 'bg-blue-100 text-blue-700',
                'cancelled': 'bg-gray-100 text-gray-500'
            } %}
            <span class="text-xs text-gray-400">&middot;</span>
            <span class="px-1.5 py-0.5 rounded text-xs {{ status_colors.get(job.status.value, 'bg-gray-100 text-gray-500') }}">
                {% if job.status.value == 'open' %}Offen{% elif job.status.value == 'paused' %}Pausiert{% elif job.status.value == 'filled' %}Besetzt{% else %}Abgesagt{% endif %}
            </span>
            {# Kandidaten Count #}
            {% set pipeline_count = job.pipeline_entries | length if job.pipeline_entries else 0 %}
            {% if pipeline_count > 0 %}
            <span class="text-xs text-gray-400">&middot;</span>
            <span class="text-xs text-gray-500">{{ pipeline_count }} Kandidat{{ 'en' if pipeline_count != 1 else '' }}</span>
            {% endif %}
        </div>
    </a>
    {% endfor %}
    {% if ats_jobs | length >= 50 %}
    <p class="text-xs text-gray-400 text-center pt-2">Zeigt max. 50 ATS-Stellen</p>
    {% endif %}
</div>
{% else %}
<div class="text-center py-4">
    <p class="text-sm text-gray-400">Keine ATS-Stellen verknuepft</p>
    <a href="/ats/stellen" class="inline-flex items-center gap-1 mt-2 text-xs text-primary-600 hover:text-primary-500">
        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
        </svg>
        Zu ATS-Stellen
    </a>
</div>
{% endif %}
