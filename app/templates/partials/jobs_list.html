{# Jobs List Partial — Premium Grid Layout #}
{# Parameter: jobs, total, page, per_page, total_pages, priority_cities, view, search #}

{% if jobs and jobs | length > 0 %}

    {# Ergebnis-Info — minimalistisch #}
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
        <div style="display:flex;align-items:center;gap:8px;">
            <span style="font-size:22px;font-weight:700;color:var(--pp-text);">{{ total }}</span>
            <span style="font-size:13px;color:var(--pp-textMuted);">
                Job{{ 's' if total != 1 else '' }}
                {% if search %} fuer &laquo;{{ search }}&raquo;{% endif %}
            </span>
        </div>
        {% if total_pages is defined and total_pages > 1 %}
        <span style="font-size:12px;color:var(--pp-textDim);">Seite {{ page }}/{{ total_pages }}</span>
        {% endif %}
    </div>

    {# ═══ Kachelansicht — Responsive Grid ═══ #}
    <div x-show="!$store.jobsView || $store.jobsView.mode !== 'list'">
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(380px,1fr));gap:14px;">
            {% for job in jobs %}
                {% include 'components/job_card.html' %}
            {% endfor %}
        </div>
    </div>

    {# ═══ Listenansicht — Modern Table ═══ #}
    <div x-show="$store.jobsView && $store.jobsView.mode === 'list'" x-cloak>
        <div style="background:var(--pp-surface);border:1px solid var(--pp-border);border-radius:14px;overflow:hidden;">
            {# Tabellen-Header #}
            <div style="display:grid;grid-template-columns:40px 3fr 2fr 2fr 2fr 120px;gap:8px;padding:12px 18px;background:var(--pp-bg);border-bottom:1px solid var(--pp-border);">
                <div>
                    <input type="checkbox"
                           onchange="document.querySelectorAll('input[name=selected_jobs]').forEach(cb => cb.checked = this.checked)"
                           style="width:16px;height:16px;border-radius:4px;cursor:pointer;">
                </div>
                <div style="font-size:11px;font-weight:600;color:var(--pp-textDim);text-transform:uppercase;letter-spacing:0.5px;">Position</div>
                <div style="font-size:11px;font-weight:600;color:var(--pp-textDim);text-transform:uppercase;letter-spacing:0.5px;">Unternehmen</div>
                <div style="font-size:11px;font-weight:600;color:var(--pp-textDim);text-transform:uppercase;letter-spacing:0.5px;">Adresse</div>
                <div style="font-size:11px;font-weight:600;color:var(--pp-textDim);text-transform:uppercase;letter-spacing:0.5px;">Importiert</div>
                <div style="font-size:11px;font-weight:600;color:var(--pp-textDim);text-transform:uppercase;letter-spacing:0.5px;text-align:right;">Aktionen</div>
            </div>

            {# Zeilen #}
            {% for job in jobs %}
                {% include 'components/job_row.html' %}
            {% endfor %}
        </div>
    </div>

    {# ═══ Pagination — Modern Pill Style ═══ #}
    {% if total_pages is defined and total_pages > 1 %}
    <div style="margin-top:24px;display:flex;align-items:center;justify-content:center;gap:6px;">
        {% if page > 1 %}
        <button hx-get="/partials/jobs-list?page={{ page - 1 }}&per_page={{ per_page }}"
                hx-target="#jobs-content"
                hx-swap="innerHTML"
                hx-include="[name='search'],[name='sort_by'],[name='imported_days'],[name='company'],[name='cities'],[name='postal_code_prefix']"
                style="padding:8px 14px;font-size:12px;font-weight:500;color:var(--pp-textMuted);background:var(--pp-surface);border:1px solid var(--pp-border);border-radius:8px;cursor:pointer;transition:all 0.15s;"
                onmouseover="this.style.borderColor='var(--pp-accent)';this.style.color='var(--pp-accent)'"
                onmouseout="this.style.borderColor='var(--pp-border)';this.style.color='var(--pp-textMuted)'">
            &larr; Zurueck
        </button>
        {% endif %}

        {% for p in range(1, total_pages + 1) %}
            {% if p == page %}
            <span style="padding:8px 14px;font-size:12px;font-weight:600;color:#fff;background:linear-gradient(135deg,var(--pp-accent),#6366F1);border-radius:8px;box-shadow:0 2px 8px rgba(79,140,255,0.25);">{{ p }}</span>
            {% elif p <= 3 or p >= total_pages - 1 or (p >= page - 1 and p <= page + 1) %}
            <button hx-get="/partials/jobs-list?page={{ p }}&per_page={{ per_page }}"
                    hx-target="#jobs-content"
                    hx-swap="innerHTML"
                    hx-include="[name='search'],[name='sort_by'],[name='imported_days'],[name='company'],[name='cities'],[name='postal_code_prefix']"
                    style="padding:8px 14px;font-size:12px;font-weight:500;color:var(--pp-textMuted);background:var(--pp-surface);border:1px solid var(--pp-border);border-radius:8px;cursor:pointer;transition:all 0.15s;"
                    onmouseover="this.style.borderColor='var(--pp-accent)';this.style.color='var(--pp-accent)'"
                    onmouseout="this.style.borderColor='var(--pp-border)';this.style.color='var(--pp-textMuted)'">
                {{ p }}
            </button>
            {% elif p == 4 or p == total_pages - 2 %}
            <span style="padding:8px 6px;font-size:12px;color:var(--pp-textDim);">...</span>
            {% endif %}
        {% endfor %}

        {% if page < total_pages %}
        <button hx-get="/partials/jobs-list?page={{ page + 1 }}&per_page={{ per_page }}"
                hx-target="#jobs-content"
                hx-swap="innerHTML"
                hx-include="[name='search'],[name='sort_by'],[name='imported_days'],[name='company'],[name='cities'],[name='postal_code_prefix']"
                style="padding:8px 14px;font-size:12px;font-weight:500;color:var(--pp-textMuted);background:var(--pp-surface);border:1px solid var(--pp-border);border-radius:8px;cursor:pointer;transition:all 0.15s;"
                onmouseover="this.style.borderColor='var(--pp-accent)';this.style.color='var(--pp-accent)'"
                onmouseout="this.style.borderColor='var(--pp-border)';this.style.color='var(--pp-textMuted)'">
            Weiter &rarr;
        </button>
        {% endif %}
    </div>
    {% endif %}

{% else %}
    {# ═══ Empty State — Premium ═══ #}
    <div style="background:var(--pp-surface);border:1px solid var(--pp-border);border-radius:16px;padding:64px 32px;text-align:center;">
        <div style="width:64px;height:64px;border-radius:16px;background:linear-gradient(135deg,var(--pp-accentSoft),var(--pp-purpleSoft));display:inline-flex;align-items:center;justify-content:center;margin-bottom:16px;">
            <svg style="width:28px;height:28px;color:var(--pp-accent);" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 00.75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 00-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0112 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 01-.673-.38m0 0A2.18 2.18 0 013 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 013.413-.387m7.5 0V5.25A2.25 2.25 0 0013.5 3h-3a2.25 2.25 0 00-2.25 2.25v.894m7.5 0a48.667 48.667 0 00-7.5 0" />
            </svg>
        </div>
        <h3 style="font-size:18px;font-weight:600;color:var(--pp-text);margin:0 0 8px;">Keine Jobs gefunden</h3>
        <p style="font-size:13px;color:var(--pp-textMuted);margin:0 0 24px;max-width:360px;display:inline-block;">
            {% if search %}
            Keine Ergebnisse fuer &laquo;{{ search }}&raquo;. Versuche andere Suchbegriffe.
            {% else %}
            Es wurden keine Jobs gefunden. Importiere neue Jobs oder aendere die Filter.
            {% endif %}
        </p>
        <div>
            <button type="button"
                    onclick="openModal('/partials/import-dialog')"
                    style="display:inline-flex;align-items:center;gap:6px;padding:10px 20px;font-size:13px;font-weight:600;color:#fff;background:linear-gradient(135deg,var(--pp-accent),#6366F1);border:none;border-radius:10px;cursor:pointer;transition:all 0.2s;box-shadow:0 2px 8px rgba(79,140,255,0.25);"
                    onmouseover="this.style.transform='translateY(-1px)';this.style.boxShadow='0 6px 20px rgba(79,140,255,0.35)'"
                    onmouseout="this.style.transform='';this.style.boxShadow='0 2px 8px rgba(79,140,255,0.25)'">
                <svg style="width:16px;height:16px;" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z" />
                    <path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" />
                </svg>
                Jobs importieren
            </button>
        </div>
    </div>
{% endif %}
